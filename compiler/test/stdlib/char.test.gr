module CharTest

from "char" include Char
from "string" include String
from "array" include Array

// isValid

assert Char.isValid(0x70)
assert Char.isValid(0x700)
assert Char.isValid(0x7000)
assert Char.isValid(0x70000)
assert !Char.isValid(-5)
assert !Char.isValid(0x11FFFF)
assert !Char.isValid(0xD8FF)

// code

// Each of these characters are represented by one, two, three, and four bytes respectively.
let testString = "\u{70}\u{700}\u{7000}\u{70000}"

let chars = String.explode(testString)
let codes = [> 0x70, 0x700, 0x7000, 0x70000]

assert Array.map(Char.code, chars) == codes

// fromCode

assert Array.map(Char.fromCode, codes) == chars

// succ
assert Char.code(Char.succ(Char.fromCode(0x70))) == 0x71
assert Char.code(Char.succ(Char.fromCode(0xD7FF))) == 0xE000

// pred
assert Char.code(Char.pred(Char.fromCode(0x70))) == 0x6F
assert Char.code(Char.pred(Char.fromCode(0xE000))) == 0xD7FF

// toString
assert Char.toString('f') == "f"
assert Char.toString('ðŸ’¯') == "ðŸ’¯"

// byteCount
assert Char.byteCount(Char.UTF8, 'a') == 1
assert Char.byteCount(Char.UTF8, 'Â©') == 2
assert Char.byteCount(Char.UTF8, 'â˜ƒ') == 3
assert Char.byteCount(Char.UTF8, 'ðŸŒ¾') == 4
assert Char.byteCount(Char.UTF16, 'a') == 1
assert Char.byteCount(Char.UTF16, 'Â©') == 1
assert Char.byteCount(Char.UTF16, 'â˜ƒ') == 1
assert Char.byteCount(Char.UTF16, 'ðŸŒ¾') == 2
assert Char.byteCount(Char.UTF32, 'a') == 4
assert Char.byteCount(Char.UTF32, 'Â©') == 4
assert Char.byteCount(Char.UTF32, 'â˜ƒ') == 4
assert Char.byteCount(Char.UTF32, 'ðŸŒ¾') == 4

// issue #927
let chars = [> '\u{1F3F4}', '\u{E0067}']
let mut charPosition = 0
let len = 2
let mut done = false

while (!done) {
  if (charPosition >= len) {
    break
  }

  Char.code(chars[charPosition])
  charPosition += 1
}

// <
use Char.{ (<) }
assert 'a' < 'z'
assert 'a' < 'b'
assert 'A' < 'Z'
assert !('z' < 'a')

// <=
use Char.{ (<=) }
assert 'a' <= 'z'
assert 'a' <= 'b'
assert 'A' <= 'Z'
assert !('z' <= 'a')
assert 'z' <= 'z'
assert 'Z' <= 'Z'

// >
use Char.{ (>) }
assert 'z' > 'a'
assert 'b' > 'a'
assert 'Z' > 'A'
assert !('a' > 'b')

// >=
use Char.{ (>=) }
assert 'z' >= 'a'
assert 'b' >= 'a'
assert 'Z' >= 'A'
assert !('a' >= 'b')
assert 'a' >= 'a'
assert 'B' >= 'B'

// Char.Ascii
module AsciiTest {
  use Char.{ module Ascii }

  // isValid
  assert Ascii.isValid('1')
  assert Ascii.isValid('a')
  assert Ascii.isValid(';')
  assert Ascii.isValid(' ')
  assert Ascii.isValid('\n')
  assert !Ascii.isValid('ðŸŒ¾')

  // isDigit
  assert Ascii.isDigit('1')
  assert !Ascii.isDigit('a')
  assert !Ascii.isDigit('ðŸŒ¾')

  // isAlpha
  assert !Ascii.isAlpha('1')
  assert Ascii.isAlpha('a')
  assert Ascii.isAlpha('Z')
  assert !Ascii.isAlpha('Î»')

  // isControl
  assert Ascii.isControl('\n')
  assert Ascii.isControl('\t')
  assert Ascii.isControl('\u{007F}')
  assert !Ascii.isControl(' ')
  assert !Ascii.isControl('a')
  assert !Ascii.isControl('ðŸŒ¾')

  // isWhitespace
  assert Ascii.isWhitespace(' ')
  assert Ascii.isWhitespace('\t')
  assert Ascii.isWhitespace('\n')
  assert Ascii.isWhitespace('\r')
  assert Ascii.isWhitespace('\x0C')
  assert !Ascii.isWhitespace('a')
  assert !Ascii.isWhitespace('1')
  assert !Ascii.isWhitespace('ðŸŒ¾')

  // isPunctuation
  assert Ascii.isPunctuation('!')
  assert Ascii.isPunctuation('?')
  assert Ascii.isPunctuation('.')
  assert Ascii.isPunctuation(',')
  assert !Ascii.isPunctuation('1')
  assert !Ascii.isPunctuation('a')
  assert !Ascii.isPunctuation('ðŸŒ¾')

  // isGraphic
  assert Ascii.isGraphic('1')
  assert Ascii.isGraphic('a')
  assert Ascii.isGraphic('!')
  assert !Ascii.isGraphic('\n')
  assert !Ascii.isGraphic('\t')
  assert !Ascii.isGraphic('ðŸŒ¾')

  // toLowercase
  assert Ascii.toLowercase('A') == 'a'
  assert Ascii.toLowercase('a') == 'a'
  assert Ascii.toLowercase('1') == '1'
  assert Ascii.toLowercase('Î»') == 'Î»'

  // toUppercase
  assert Ascii.toUppercase('a') == 'A'
  assert Ascii.toUppercase('A') == 'A'
  assert Ascii.toUppercase('1') == '1'
  assert Ascii.toUppercase('Î»') == 'Î»'
}
